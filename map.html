<!DOCTYPE html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Children's Hospitals Association</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://code.highcharts.com/highcharts.js"></script>
  <script src="https://code.highcharts.com/maps/modules/map.js"></script>
  <!-- Include the Highcharts Map Collection -->
  <script src="https://code.highcharts.com/mapdata/custom/world.js"></script>
  <!-- Include your JSON data file for the map -->
  <script src="Florida_counties.json"></script>
</head>
<body>
  <!-- Your existing HTML content goes here -->

  <script>
    // Your JavaScript code for rendering the map goes here
    document.addEventListener('DOMContentLoaded', async () => {
      try {
        // Fetch the map data (Florida counties) from the loaded JSON file
        const mapData = FLORIDA_COUNTIES; // This variable should be defined in Florida_counties.json

        // Fetch the Medicaid regions data
        const medicaidRegionsData = [
          // ... (paste the JSON data here)
        ];

        // Combine the map data and Medicaid regions data
        const combinedData = mapData.features.map(county => {
          const countyName = county.properties.NAME;
          const medicaidRegion = medicaidRegionsData.find(region => region.COUNTY === countyName);
          if (medicaidRegion) {
            return { ...county, region: medicaidRegion['MEDICAID REGION'] };
          }
          return county;
        });

        // Instantiate the map
        Highcharts.mapChart('mapContainer', {
          chart: {
            map: mapData
          },
          // Your other map settings go here...

          series: [{
            name: 'Counties',
            data: combinedData,
            mapData: mapData,
            joinBy: ['name', 'properties.NAME'],
            tooltip: {
              headerFormat: '',
              pointFormat: '<b>{point.properties.NAME}</b><br>Medicaid Region: {point.region}'
            }
          }]
        });

      } catch (error) {
        console.error('Error fetching map data:', error);
      }
    });
  </script>
</body>
</html>
